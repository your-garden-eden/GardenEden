// /src/app/features/product-page/product-page.component.scss

@use "sass:color"; // Wird nur noch für color.adjust benötigt

// Definition aller Farben als CSS Variablen im Host-Element
:host {
  // Seitenhintergrund
  --page-background-color: #FAF8F0; // Hellbeige

  // Gradientenfarben (aus Header)
  --gradient-end: #e8f5e9;
  --gradient-start: #D2B48C;

  // Textfarben
  --text-color-main: #333;       // Standard Text (z.B. auf weißem Grund)
  --text-color-light: #666;
  --text-color-on-gradient: #4E342E; // Text auf dem Gradienten
  // SCSS Berechnung für Fallback/Konsistenz
  --text-color-light-on-gradient: #{lighten(#4E342E, 15%)}; // SASS Berechnung

  // Button/Akzentfarben
  --primary-color: #28a745; // Grün für "In den Warenkorb"
  --primary-color-hover: #{color.adjust(#28a745, $lightness: -10%)}; // SASS Berechnung
  --price-color: #2e6b2e; // Preis Grün
  --instock-color: #5cb85c;
  --instock-color-on-gradient: #{color.adjust(#5cb85c, $lightness: -15%)}; // SASS Berechnung
  --outofstock-color-on-gradient: #{color.adjust(#dc3545, $lightness: -15%, $saturation: -10%)}; // SASS Berechnung

  // Wunschliste/Fehler Farben
  --wishlist-icon-color: #d9534f;
  --wishlist-hover-bg: rgba(217, 83, 79, 0.1);
  --error-color: #dc3545;
  --error-background-light: #{color.adjust(#dc3545, $lightness: 55%, $saturation: -20%)}; // SASS Berechnung
  --error-border-light: #{color.adjust(#dc3545, $lightness: 40%, $saturation: -15%)}; // SASS Berechnung
  --error-text-dark: #{color.adjust(#dc3545, $lightness: -10%)}; // SASS Berechnung

  // Andere UI-Farben
  --disabled-color: #cccccc;
  --thumbnail-border-color: #ddd;
  --thumbnail-border-color-hover: #999;
  --thumbnail-border-color-selected: #333; // War vorher Sass Var


  // --- Host Styling mit fester Hintergrundfarbe ---
  display: block;
  background-color: var(--page-background-color); // Nutzt CSS Variable
  min-height: 100vh;
  padding: 2rem 0;
  // --- Ende Host Styling ---
}

// --- Inhalts-Container mit Gradient ---
.product-page-content {
  max-width: 1200px;
  margin: 0 auto;
  background-image: linear-gradient(to bottom, var(--gradient-start), var(--gradient-end)); // Nutzt CSS Vars
  border-radius: 8px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.15);
  padding: 2rem;
  color: var(--text-color-on-gradient); // Nutzt CSS Var
}
// --- Ende Anpassung ---

// --- Kreativeres Styling für den Zurück-Button ---
.back-button {
  display: inline-flex;
  align-items: center;
  gap: 8px; // Etwas mehr Abstand
  background-color: transparent;
  border: 1px solid var(--text-color-on-gradient); // Klarerer Rand
  color: var(--text-color-on-gradient);
  padding: 8px 18px; // Mehr Padding
  border-radius: 50px; // Pillenform
  font-size: 0.9rem;
  font-weight: 600; // Etwas dicker
  text-decoration: none;
  cursor: pointer;
  transition: all 0.25s ease-out; // Übergang für alle Eigenschaften
  margin-bottom: 1.5rem; // Abstand nach unten

  .material-symbols-outlined {
    font-size: 20px;
    transition: transform 0.25s ease-out; // Für Icon-Animation (optional)
  }

  &:hover {
    background-color: var(--text-color-on-gradient); // Hintergrund füllt sich
    color: var(--page-background-color); // Text/Icon wird hell (Kontrast)
    border-color: var(--text-color-on-gradient); // Rand "verschwindet" im Hintergrund
    transform: translateY(-1px); // Leichter Lift-Effekt
    box-shadow: 0 3px 6px rgba(0, 0, 0, 0.1); // Subtiler Schatten

    .material-symbols-outlined {
       // Optional: Kleine Icon-Animation beim Hovern
       // transform: translateX(-2px);
    }
  }

  &:active { // Wenn geklickt wird
      transform: translateY(0);
      box-shadow: none;
  }

  &:focus-visible { // Für Tastaturnavigation
    outline: none;
    box-shadow: 0 0 0 3px rgba(40, 167, 69, 0.4); // Etwas größerer Fokusring
  }
}
// --- ENDE Styling Zurück-Button ---

.product-detail-container { }

.product-main-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 2rem;
  align-items: start;
   @media (max-width: 992px) { grid-template-columns: 1fr; gap: 2.5rem; }
}

// --- Lade- & Fehleranzeigen ---
.loading-indicator {
  text-align: center;
  padding: 50px;
  color: var(--text-color-light-on-gradient); // Nutzt CSS Var
}
.error-message {
  &.general-error {
    margin: 20px 0; padding: 15px; background-color: rgba(255, 255, 255, 0.8);
    border: 1px solid var(--error-border-light); border-radius: 4px;
    text-align: center; font-weight: 500; color: var(--error-text-dark);
     a { color: var(--error-text-dark); text-decoration: underline; font-weight: bold; }
  }
  &.cart-error { margin-top: 15px; color: var(--error-color); font-weight: 500; }
}

// --- Linke Spalte: Medien-Galerie ---
.product-media-gallery {
   display: flex; flex-direction: column;
    .main-image-container {
      border: 1px solid rgba(0,0,0,0.1); margin-bottom: 1rem; position: relative;
      background-color: #fff; min-height: 300px; display: flex; align-items: center;
      justify-content: center; border-radius: 4px; overflow: hidden;
      img { display: block; width: 100%; height: auto; max-height: 600px; object-fit: contain; }
      .no-image-placeholder { /* ... */ }
    }
    .thumbnail-container {
      display: grid; grid-template-columns: repeat(auto-fill, minmax(65px, 1fr)); gap: 8px;
      .thumbnail {
        border: 2px solid transparent; cursor: pointer; transition: border-color 0.2s ease-in-out;
        width: 100%; aspect-ratio: 1 / 1; display: flex; align-items: center;
        justify-content: center; overflow: hidden; background-color: #fff; border-radius: 4px;
        img { max-width: 100%; max-height: 100%; display: block; object-fit: contain; }
        &:hover { border-color: var(--thumbnail-border-color-hover); } // Nutzt CSS Var
        &.selected { border-color: var(--thumbnail-border-color-selected); } // Nutzt CSS Var
      }
    }
}

// --- Rechte Spalte: Produkt-Infos ---
.product-info {
   h1.product-title { // Selektor präzisiert
      margin-top: 0; margin-bottom: 0.75rem; font-size: 1.8em; line-height: 1.3;
      color: var(--text-color-on-gradient); // Nutzt CSS Var
    }
    .price-section {
      margin-bottom: 0.75rem; font-size: 1.6em; font-weight: 600;
      .current-price { color: var(--price-color); } // Nutzt CSS Var
    }
    .availability-section {
      margin-bottom: 1.5rem; font-size: 0.95em; font-weight: 500;
      .in-stock { color: var(--instock-color-on-gradient); } // Nutzt CSS Var
      .out-of-stock { color: var(--outofstock-color-on-gradient); font-weight: bold;} // Nutzt CSS Var
    }
    .action-buttons-section {
      margin-top: 1.5rem; margin-bottom: 1.5rem; display: flex; flex-wrap: nowrap; gap: 10px; align-items: center;
      .action-button { // Gemeinsame Stile für Aktionsbuttons
          display: inline-flex; align-items: center; justify-content: center; gap: 8px; border-radius: 5px;
          font-size: 1rem; font-weight: 600; cursor: pointer;
          transition: background-color 0.2s ease, color 0.2s ease, filter 0.2s ease, opacity 0.2s ease, transform 0.2s ease;
          border: none; white-space: nowrap;
          .material-symbols-outlined { vertical-align: middle; font-size: 20px; }
          &:disabled { background-color: var(--disabled-color) !important; border-color: var(--disabled-color) !important; color: #fff !important; cursor: not-allowed; opacity: 0.7; filter: grayscale(50%); &:hover { transform: none; filter: grayscale(50%); } }
      }
      .add-to-cart-btn {
        background-color: var(--primary-color); // Nutzt CSS Var
        color: white; flex-grow: 1; padding: 12px 15px;
        &:hover:not(:disabled) {
           filter: brightness(90%);
           background-color: var(--primary-color); // Stellt sicher, dass BG bleibt
        }
        .button-loading-spinner { border: 2px solid rgba(255, 255, 255, 0.3); border-radius: 50%; border-top-color: #fff; width: 16px; height: 16px; animation: spin 1s ease-infinite; margin-right: 8px; }
      }
      .add-to-wishlist-btn {
          background-color: transparent; color: var(--text-color-light-on-gradient); // Nutzt CSS Var
          border: none; padding: 10px; border-radius: 50%; flex-shrink: 0; outline: none;
          &:focus-visible { box-shadow: 0 0 0 2px rgba(40, 167, 69, 0.5); } // Nutzt CSS Var für Fokus (Primärfarbe)
          &:hover:not(:disabled) { background-color: var(--wishlist-hover-bg); color: var(--wishlist-icon-color); } // Nutzt CSS Vars
          .wishlist-icon { color: inherit; font-size: 24px; transition: transform 0.2s ease, color 0.2s ease; &.filled { color: var(--wishlist-icon-color); font-variation-settings: 'FILL' 1; } }
      }
    }
    .description-section {
       margin-top: 2rem;
       h3 { margin-bottom: 10px; font-size: 1.1rem; color: var(--text-color-on-gradient); } // Nutzt CSS Var
       div[innerHTML] {
           line-height: 1.6; color: var(--text-color-light-on-gradient); font-size: 0.95rem; // Nutzt CSS Var
           ul, ol { margin-left: 20px; margin-bottom: 1em; padding-left: 1em; } li { margin-bottom: 0.5em; }
           p { margin-bottom: 1em; } strong { font-weight: bold; color: var(--text-color-on-gradient); } // Nutzt CSS Var
           a { color: var(--primary-color); text-decoration: underline; &:hover { color: var(--primary-color-hover); filter: none; } } // Nutzt CSS Vars
       }
    }
}

// --- Responsive ---
@media (max-width: 768px) {
     .product-main-grid { grid-template-columns: 1fr; gap: 1.5rem; }
     .product-media-gallery {
         .main-image-container { max-width: 85%; margin-left: auto; margin-right: auto; }
         .thumbnail-container { justify-content: flex-start; grid-template-columns: repeat(auto-fill, minmax(60px, 1fr)); }
     }
     .product-info {
         h1.product-title { font-size: 1.4em; } // Selektor präzisiert
         .price-section { font-size: 1.3em; }
         .action-buttons-section {
            flex-direction: column; align-items: stretch; // Stretch für volle Breite der Buttons
            .add-to-cart-btn { width: 100%; justify-content: center; }
            .add-to-wishlist-btn { width: auto; align-self: center; margin-top: 10px; } // Zentriert sich selbst
         }
     }
     .product-page-content { padding: 1rem; margin: 1rem; } // Weniger Padding/Margin auf Mobile
}

// --- Keyframes ---
@keyframes spin { to { transform: rotate(360deg); } }