<!-- /src/app/features/category-overview/category-overview.component.html -->
<div class="category-overview-page">

  <!-- Titel der Hauptkategorie (kommt bereits übersetzt aus dem TS) -->
  <h1 *ngIf="categoryTitle() && !error()">{{ categoryTitle() }}</h1>

  <!-- Fehleranzeige für Hauptkategorie (error() wird bereits übersetzt aus dem TS) -->
  <div *ngIf="error()" class="error-message">
    <p>{{ error() }}</p>
    <a routerLink="/">{{ 'categoryOverview.backToHome' | transloco }}</a>
  </div>

  <!-- Container für Unterkategorien (Icons) -->
  <div *ngIf="!error() && subCategories().length > 0" class="subcategories-container">
    <a *ngFor="let subItem of subCategories()"
       [routerLink]="subItem.link"
       class="subcategory-item">
      <img *ngIf="subItem.iconFilename"
           [src]="getIconPath(subItem.iconFilename)"
           [alt]="subItem.i18nId | transloco" 
           class="subcategory-icon"
           loading="lazy">
      <span class="subcategory-label">{{ subItem.i18nId | transloco }}</span> <!-- Label übersetzen -->
    </a>
  </div>

  <!-- Meldung, wenn keine Unterkategorien gefunden wurden -->
  <div *ngIf="!error() && subCategories().length === 0 && categoryTitle()">
    <!-- categoryTitle() ist bereits übersetzt -->
    <p>{{ 'categoryOverview.noSubcategories' | transloco:{ category: categoryTitle() } }}</p>
  </div>

  <!-- ======================================== -->
  <!-- Sektion für EINFACHE Produktvorschau     -->
  <!-- ======================================== -->
  <section class="product-preview-section" *ngIf="!error()">

    <h2 *ngIf="!isLoadingPreview() && !previewError() && productPreview().length > 0">
      {{ 'categoryOverview.popularProducts' | transloco }}
    </h2>

    <div *ngIf="isLoadingPreview()" class="loading-indicator preview-loading">
      <p>{{ 'categoryOverview.loadingPreview' | transloco }}</p>
    </div>

    <!-- Fehleranzeige für die Vorschau (previewError() wird bereits übersetzt aus dem TS) -->
    <div *ngIf="previewError()" class="error-message preview-error">
      <p>{{ previewError() }}</p>
    </div>

    <div *ngIf="!isLoadingPreview() && !previewError() && productPreview().length > 0" class="product-preview-grid">
      <app-product-card
          *ngFor="let product of productPreview(); trackBy: trackPreviewProductById"
          [product]="product">
      </app-product-card>
    </div>

     <div *ngIf="!isLoadingPreview() && !previewError() && productPreview().length === 0 && subCategories().length > 0" class="no-products-message">
       <p>{{ 'categoryOverview.noPreviewProducts' | transloco }}</p>
     </div>

  </section>
</div>